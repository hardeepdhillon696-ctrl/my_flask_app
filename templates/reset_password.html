
{% extends "base.html" %}

{% block title %}Reset Password{% endblock %}

{% block content %}
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} text-center">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="container" style="margin-top: 100px; max-width: 500px;">
  <h2 class="mb-4 text-center">üîí Reset Your Password</h2>
  <p class="text-muted text-center">Reset password for <strong>{{ email }}</strong></p>

  <form method="POST" action="">
    <div class="form-floating mb-3">
      <input type="password" class="form-control" name="password" id="passwordInput" placeholder="Enter new password" required>
      <label for="passwordInput">New Password</label>
    </div>
    <div id="passwordHelp" class="form-text text-danger mb-3"></div>

    <button class="btn btn-gradient w-100" id="resetBtn" disabled>‚úÖ Reset Password</button>
  </form>

  <div class="text-center mt-3">
    <a href="{{ url_for('login') }}">‚¨Ö Back to Login</a>
  </div>
</div>

<script>
document.getElementById("passwordInput").addEventListener("input", function () {
  const password = this.value;
  const helpText = document.getElementById("passwordHelp");
  const resetBtn = document.getElementById("resetBtn");

  const minLength = /.{8,}/;
  const upper = /[A-Z]/;
  const lower = /[a-z]/;
  const number = /[0-9]/;
  const special = /[^A-Za-z0-9]/;

  if (!minLength.test(password)) {
    helpText.textContent = "‚ùå Password must be at least 8 characters long.";
    resetBtn.disabled = true;
  } else if (!upper.test(password)) {
    helpText.textContent = "‚ùå Must contain at least one uppercase letter.";
    resetBtn.disabled = true;
  } else if (!lower.test(password)) {
    helpText.textContent = "‚ùå Must contain at least one lowercase letter.";
    resetBtn.disabled = true;
  } else if (!number.test(password)) {
    helpText.textContent = "‚ùå Must contain at least one number.";
    resetBtn.disabled = true;
  } else if (!special.test(password)) {
    helpText.textContent = "‚ùå Must contain at least one special character.";
    resetBtn.disabled = true;
  } else {
    helpText.textContent = "‚úÖ Strong password!";
    helpText.classList.remove("text-danger");
    helpText.classList.add("text-success");
    resetBtn.disabled = false;
  }
});
</script>
{% endblock %}

